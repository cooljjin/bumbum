<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë²½ ì¶©ëŒ í…ŒìŠ¤íŠ¸ - ê°„ë‹¨ ë²„ì „</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            font-weight: bold;
        }
        .success {
            background: #e8f5e8;
            color: #2e7d32;
            border: 1px solid #4caf50;
        }
        .error {
            background: #ffebee;
            color: #c62828;
            border: 1px solid #f44336;
        }
        .info {
            background: #e3f2fd;
            color: #1565c0;
            border: 1px solid #2196f3;
        }
        button {
            background: #2196f3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #1976d2;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            background: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ  ê°€êµ¬ ë²½ ì¶©ëŒ ê°ì§€ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="status info">
            <strong>í…ŒìŠ¤íŠ¸ ëª©ì :</strong> ê°€êµ¬ê°€ ë°© ê²½ê³„(ë²½)ë¥¼ ëš«ê³  ì§€ë‚˜ê°€ì§€ ì•ŠëŠ”ì§€ í™•ì¸
        </div>

        <div class="status info">
            <strong>ë°© í¬ê¸°:</strong> 15m x 15m (ì—¬ë°± 0.5m í¬í•¨)<br>
            <strong>ì‚¬ìš© ê°€ëŠ¥ ê³µê°„:</strong> 14m x 14m (ì¤‘ì•™ ê¸°ì¤€ -7m ~ +7m)
        </div>

        <div>
            <button onclick="testWallCollision()">ë²½ ì¶©ëŒ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
            <button onclick="testFurniturePlacement()">ê°€êµ¬ ë°°ì¹˜ í…ŒìŠ¤íŠ¸</button>
            <button onclick="clearResults()">ê²°ê³¼ ì§€ìš°ê¸°</button>
        </div>

        <div id="testResults"></div>
    </div>

    <script>
        // ë°© ê²½ê³„ ì„¤ì • (ì‹¤ì œ ì½”ë“œì™€ ë™ì¼)
        const ROOM_DIMENSIONS = {
            width: 15,
            depth: 15,
            height: 7.5,
            wallThickness: 0.1,
            margin: 0.5
        };

        // ë°© ê²½ê³„ ê³„ì‚°
        function getRoomBoundaries() {
            const halfWidth = ROOM_DIMENSIONS.width / 2;
            const halfDepth = ROOM_DIMENSIONS.depth / 2;
            
            return {
                minX: -halfWidth + ROOM_DIMENSIONS.margin,
                maxX: halfWidth - ROOM_DIMENSIONS.margin,
                minZ: -halfDepth + ROOM_DIMENSIONS.margin,
                maxZ: halfDepth - ROOM_DIMENSIONS.margin,
                minY: 0,
                maxY: ROOM_DIMENSIONS.height - ROOM_DIMENSIONS.margin
            };
        }

        // ê°€êµ¬ ê²½ê³„ ê³„ì‚°
        function getFurnitureBounds(item, safetyMargin = 0.1) {
            const halfWidth = (item.footprint.width * item.scale.x) / 2;
            const halfDepth = (item.footprint.depth * item.scale.z) / 2;
            const height = item.footprint.height * item.scale.y;
            
            return {
                minX: item.position.x - halfWidth - safetyMargin,
                maxX: item.position.x + halfWidth + safetyMargin,
                minZ: item.position.z - halfDepth - safetyMargin,
                maxZ: item.position.z + halfDepth + safetyMargin,
                minY: item.position.y,
                maxY: item.position.y + height + safetyMargin
            };
        }

        // ë²½ ì¶©ëŒ ê°ì§€
        function isFurnitureInRoom(item) {
            const boundaries = getRoomBoundaries();
            const furnitureBounds = getFurnitureBounds(item);
            
            // Xì¶• ê²€ì¦
            if (furnitureBounds.minX < boundaries.minX || furnitureBounds.maxX > boundaries.maxX) {
                return false;
            }
            
            // Zì¶• ê²€ì¦
            if (furnitureBounds.minZ < boundaries.minZ || furnitureBounds.maxZ > boundaries.maxZ) {
                return false;
            }
            
            // Yì¶• ê²€ì¦
            if (furnitureBounds.minY < boundaries.minY || furnitureBounds.maxY > boundaries.maxY) {
                return false;
            }
            
            return true;
        }

        // ê°€êµ¬ë¥¼ ë°© ì•ˆìœ¼ë¡œ ì œí•œ
        function constrainFurnitureToRoom(item) {
            const boundaries = getRoomBoundaries();
            const furnitureBounds = getFurnitureBounds(item);
            
            const halfWidth = (item.footprint.width * item.scale.x) / 2;
            const halfDepth = (item.footprint.depth * item.scale.z) / 2;
            const height = item.footprint.height * item.scale.y;
            
            let newX = item.position.x;
            let newZ = item.position.z;
            let newY = item.position.y;
            
            // Xì¶• ì œí•œ
            if (furnitureBounds.minX < boundaries.minX) {
                newX = boundaries.minX + halfWidth;
            } else if (furnitureBounds.maxX > boundaries.maxX) {
                newX = boundaries.maxX - halfWidth;
            }
            
            // Zì¶• ì œí•œ
            if (furnitureBounds.minZ < boundaries.minZ) {
                newZ = boundaries.minZ + halfDepth;
            } else if (furnitureBounds.maxZ > boundaries.maxZ) {
                newZ = boundaries.maxZ - halfDepth;
            }
            
            // Yì¶• ì œí•œ
            if (furnitureBounds.minY < boundaries.minY) {
                newY = boundaries.minY;
            } else if (furnitureBounds.maxY > boundaries.maxY) {
                newY = boundaries.maxY - height;
            }
            
            return {
                ...item,
                position: { x: newX, y: newY, z: newZ }
            };
        }

        // í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ë“¤
        function testWallCollision() {
            const results = document.getElementById('testResults');
            results.innerHTML = '<h3>ğŸ§ª ë²½ ì¶©ëŒ í…ŒìŠ¤íŠ¸ ê²°ê³¼</h3>';
            
            const boundaries = getRoomBoundaries();
            results.innerHTML += `<div class="test-result"><strong>ë°© ê²½ê³„:</strong> X: ${boundaries.minX.toFixed(2)} ~ ${boundaries.maxX.toFixed(2)}, Z: ${boundaries.minZ.toFixed(2)} ~ ${boundaries.maxZ.toFixed(2)}</div>`;
            
            const testPositions = [
                { x: 0, z: 0, name: 'ë°© ì¤‘ì•™' },
                { x: 6, z: 0, name: 'Xì¶• ë²½ ê·¼ì²˜' },
                { x: 0, z: 6, name: 'Zì¶• ë²½ ê·¼ì²˜' },
                { x: 7.5, z: 0, name: 'Xì¶• ë²½ ë°–' },
                { x: 0, z: 7.5, name: 'Zì¶• ë²½ ë°–' },
                { x: 8, z: 8, name: 'ëŒ€ê°ì„  ë²½ ë°–' }
            ];
            
            testPositions.forEach(pos => {
                const testItem = {
                    name: 'ì†ŒíŒŒ',
                    footprint: { width: 2.2, depth: 0.9, height: 0.8 },
                    scale: { x: 1, y: 1, z: 1 },
                    position: { x: pos.x, y: 0, z: pos.z }
                };
                
                const isInRoom = isFurnitureInRoom(testItem);
                const constrained = constrainFurnitureToRoom(testItem);
                
                const resultDiv = document.createElement('div');
                resultDiv.className = `test-result ${isInRoom ? 'success' : 'error'}`;
                resultDiv.innerHTML = `
                    <strong>${pos.name} (${pos.x}, ${pos.z}):</strong> 
                    ${isInRoom ? 'âœ… ë°© ì•ˆ' : 'âŒ ë²½ ì¶©ëŒ'} 
                    ${!isInRoom ? `â†’ ì œí•œëœ ìœ„ì¹˜: (${constrained.position.x.toFixed(2)}, ${constrained.position.z.toFixed(2)})` : ''}
                `;
                results.appendChild(resultDiv);
            });
        }

        function testFurniturePlacement() {
            const results = document.getElementById('testResults');
            results.innerHTML = '<h3>ğŸª‘ ê°€êµ¬ ë°°ì¹˜ í…ŒìŠ¤íŠ¸ ê²°ê³¼</h3>';
            
            const furnitureTypes = [
                { name: 'ì†ŒíŒŒ', footprint: { width: 2.2, depth: 0.9, height: 0.8 } },
                { name: 'ì¹¨ëŒ€', footprint: { width: 1.6, depth: 2.0, height: 0.6 } },
                { name: 'ì±…ì¥', footprint: { width: 1.2, depth: 0.3, height: 1.8 } },
                { name: 'í…Œì´ë¸”', footprint: { width: 1.0, depth: 1.0, height: 0.7 } }
            ];
            
            furnitureTypes.forEach(furniture => {
                const testItem = {
                    name: furniture.name,
                    footprint: furniture.footprint,
                    scale: { x: 1, y: 1, z: 1 },
                    position: { x: 0, y: 0, z: 0 }
                };
                
                const isInRoom = isFurnitureInRoom(testItem);
                const resultDiv = document.createElement('div');
                resultDiv.className = `test-result ${isInRoom ? 'success' : 'error'}`;
                resultDiv.innerHTML = `
                    <strong>${furniture.name} (${furniture.footprint.width}m x ${furniture.footprint.depth}m x ${furniture.footprint.height}m):</strong> 
                    ${isInRoom ? 'âœ… ë°© ì¤‘ì•™ ë°°ì¹˜ ê°€ëŠ¥' : 'âŒ ë°°ì¹˜ ë¶ˆê°€ëŠ¥'}
                `;
                results.appendChild(resultDiv);
            });
        }

        function clearResults() {
            document.getElementById('testResults').innerHTML = '';
        }

        // ì´ˆê¸° í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        testWallCollision();
    </script>
</body>
</html>
